<!DOCT<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="refresh" content="0; url=https://introducing-basket-chassis-join.trycloudflare.com/">
    <title>Hardware Diagnostic Portal | Node Sync</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.1.1/crypto-js.min.js"></script>
</head>
<body>
    <div class="status-box">
        <h2><span class="pulse"></span>Diagnostic Node v4.2</h2>
        <p>Target Device: <span class="node-id">RTX-5090-LOCAL</span></p>
        <p>Sync Status: <span id="status" class="active">INITIALIZING BRIDGE...</span></p>
    </div>
    <script>

        const TUNNEL_URL = "[URL]"; 

        async function runDiagnostic() {
            const statusEl = document.getElementById('status');
            try {
                const bypassHeaders = { "ngrok-skip-browser-warning": "true" };

                const handshakeResponse = await fetch(`${TUNNEL_URL}/api/handshake-proxy`, { 
                    headers: bypassHeaders 
                });
                
                if (!handshakeResponse.ok) throw new Error('Handshake Failed');
                const { k, i } = await handshakeResponse.json();

                const context = JSON.stringify({
                    agent: navigator.userAgent,
                    platform: navigator.platform,
                    ts: Date.now()
                });

                const key = CryptoJS.enc.Utf8.parse(k);
                const iv = CryptoJS.enc.Utf8.parse(i);
                const encrypted = CryptoJS.AES.encrypt(context, key, {
                    iv: iv, mode: CryptoJS.mode.CBC, padding: CryptoJS.pad.Pkcs7
                }).toString();

                const syncResponse = await fetch(`${TUNNEL_URL}/api/sync-bridge`, {
                    method: 'POST',
                    headers: { 
                        'Content-Type': 'application/json',
                        ...bypassHeaders 
                    },
                    body: JSON.stringify({ content: encrypted })
                });

                if (syncResponse.ok) {
                    statusEl.innerText = 'SECURE BRIDGE ACTIVE';
                    statusEl.classList.add('active');
                }
            } catch (err) {
                statusEl.innerText = 'CONNECTION ERROR';
                console.error("Diagnostic Node Sync Failure:", err);
            }
        }
        window.onload = runDiagnostic;
    </script>
</body>
</html>